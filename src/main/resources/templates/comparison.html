<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scope Vergleich</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <header>
        <h1>üìä Scope Vergleich</h1>
        <p class="subtitle">Alle Scopes auf einen Blick</p>
        <a th:href="@{/}" class="btn btn-secondary">‚Üê Zur√ºck zur √úbersicht</a>
    </header>

    <div class="container">
        <div class="info-box">
            <h3>üéØ Was siehst du hier?</h3>
            <p>
                Diese Seite zeigt alle Scopes gleichzeitig an. Reload die Seite mehrmals und beobachte, 
                welche Counter sich √§ndern und welche gleich bleiben!
            </p>
            <p>
                <strong>Pro-Tipp:</strong> √ñffne die Seite in verschiedenen Tabs und im Inkognito-Modus, 
                um die Unterschiede zwischen den Scopes zu verstehen!
            </p>
        </div>

        <div class="scope-grid">
            <!-- Singleton -->
            <div class="demo-section">
                <h2>üîµ Singleton Scope</h2>
                <pre th:text="${singleton}">Singleton Info</pre>
                <p><strong>Erwartung:</strong> Counter steigt bei JEDEM Reload, egal welcher Tab!</p>
            </div>

            <!-- Request -->
            <div class="demo-section">
                <h2>üü° Request Scope</h2>
                <pre th:text="${request}">Request Info</pre>
                <p><strong>Erwartung:</strong> Counter ist immer 1, neue ID bei jedem Reload!</p>
            </div>

            <!-- Session -->
            <div class="demo-section">
                <h2>üü£ Session Scope</h2>
                <pre th:text="${session}">Session Info</pre>
                <p><strong>Erwartung:</strong> Counter steigt in derselben Session, neue ID in Inkognito!</p>
            </div>

            <!-- Application -->
            <div class="demo-section">
                <h2>üî¥ Application Scope</h2>
                <pre th:text="${application}">Application Info</pre>
                <p><strong>Erwartung:</strong> Counter steigt f√ºr ALLE User, gleiche ID √ºberall!</p>
            </div>
        </div>

        <div style="text-align: center; margin: 3rem 0;">
            <button class="btn" onclick="location.reload()">üîÑ Reload & Testen</button>
        </div>

        <div class="demo-section">
            <h2>üß™ Experimentier-Guide</h2>
            
            <h3>Experiment 1: Reload im selben Tab</h3>
            <ul>
                <li>‚úÖ Singleton: Counter steigt (1 ‚Üí 2 ‚Üí 3 ...)</li>
                <li>‚úÖ Request: Counter bleibt bei 1 (neue Instanz!)</li>
                <li>‚úÖ Session: Counter steigt (1 ‚Üí 2 ‚Üí 3 ...)</li>
                <li>‚úÖ Application: Counter steigt (1 ‚Üí 2 ‚Üí 3 ...)</li>
            </ul>

            <h3>Experiment 2: Neuer Tab (gleiche Session)</h3>
            <ul>
                <li>‚úÖ Singleton: Counter steigt weiter (shared!)</li>
                <li>‚úÖ Request: Counter bei 1 (neue Instanz!)</li>
                <li>‚úÖ Session: Counter steigt weiter (gleiche Session!)</li>
                <li>‚úÖ Application: Counter steigt weiter (shared!)</li>
            </ul>

            <h3>Experiment 3: Inkognito-Modus (neue Session)</h3>
            <ul>
                <li>‚úÖ Singleton: Counter steigt weiter (shared!)</li>
                <li>‚úÖ Request: Counter bei 1 (neue Instanz!)</li>
                <li>‚úÖ Session: Counter bei 1 (NEUE Session!)</li>
                <li>‚úÖ Application: Counter steigt weiter (shared!)</li>
            </ul>
        </div>

        <div class="demo-section">
            <h2>üìö Wann nutze ich welchen Scope?</h2>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Scope</th>
                        <th>Use Cases</th>
                        <th>Vorsicht bei...</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Singleton</strong></td>
                        <td>
                            ‚Ä¢ Services<br>
                            ‚Ä¢ Repositories<br>
                            ‚Ä¢ Stateless Beans<br>
                            ‚Ä¢ Configuration
                        </td>
                        <td>
                            ‚Ä¢ Mutable State<br>
                            ‚Ä¢ Thread-Safety!<br>
                            ‚Ä¢ Instance Variables
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Prototype</strong></td>
                        <td>
                            ‚Ä¢ Commands<br>
                            ‚Ä¢ Stateful Objekte<br>
                            ‚Ä¢ Tasks<br>
                            ‚Ä¢ DTOs mit Logic
                        </td>
                        <td>
                            ‚Ä¢ Memory-Leaks<br>
                            ‚Ä¢ Expensive Objects<br>
                            ‚Ä¢ @PreDestroy l√§uft nicht!
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Request</strong></td>
                        <td>
                            ‚Ä¢ Request-Daten<br>
                            ‚Ä¢ User Input<br>
                            ‚Ä¢ Request Context<br>
                            ‚Ä¢ Temporary Data
                        </td>
                        <td>
                            ‚Ä¢ Nur in Web-Apps!<br>
                            ‚Ä¢ ProxyMode n√∂tig<br>
                            ‚Ä¢ Performance
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Session</strong></td>
                        <td>
                            ‚Ä¢ User-Daten<br>
                            ‚Ä¢ Shopping Cart<br>
                            ‚Ä¢ Preferences<br>
                            ‚Ä¢ Login State
                        </td>
                        <td>
                            ‚Ä¢ Memory Usage!<br>
                            ‚Ä¢ Session Timeout<br>
                            ‚Ä¢ ProxyMode n√∂tig
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Application</strong></td>
                        <td>
                            ‚Ä¢ Global Counters<br>
                            ‚Ä¢ App-wide Cache<br>
                            ‚Ä¢ Statistics<br>
                            ‚Ä¢ Shared Config
                        </td>
                        <td>
                            ‚Ä¢ Thread-Safety!<br>
                            ‚Ä¢ ProxyMode n√∂tig<br>
                            ‚Ä¢ √Ñhnlich wie Singleton
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="info-box">
            <h3>üí° Key Takeaways</h3>
            <ul>
                <li>‚úÖ <strong>Singleton</strong> ist der Default - nutze ihn f√ºr 90% deiner Beans!</li>
                <li>‚úÖ <strong>Prototype</strong> nur wenn du wirklich neue Instanzen brauchst</li>
                <li>‚úÖ <strong>Request</strong> f√ºr tempor√§re, request-spezifische Daten</li>
                <li>‚úÖ <strong>Session</strong> f√ºr User-Daten w√§hrend der Session</li>
                <li>‚úÖ <strong>Application</strong> selten n√∂tig, meist ist Singleton besser</li>
                <li>‚ö†Ô∏è Web-Scopes brauchen <code>proxyMode = TARGET_CLASS</code>!</li>
                <li>‚ö†Ô∏è Achte auf Thread-Safety bei Singleton und Application!</li>
            </ul>
        </div>
    </div>

    <footer>
        <p>&copy; 2024 Java Fleet Systems Consulting - Spring Boot Basic Tag 7</p>
    </footer>
</body>
</html>
